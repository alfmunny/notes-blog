---
title: Server Configuration Notes In the Shell
date: 2017-07-13 13:28:35
tags: [notes, shell]
categories: [posts]
toc: true
---
## Docker

### installation

[Official Website](https://docs.docker.com/engine/installation/linux/docker-ce/ubuntu)


### add docker group

`sudo groupadd docker`

`sudo usermod -aG docker $USER`

Try to run: `docker run hello-world`

### build a image

`docker build -t logsearcherbackend .`

### run a container

`docker run -d -p 2223:2223 logsearcherbackend`


## Mysql

### installation
```
sudo apt-get update
sudo apt-get install mysql-server
sudo mysql_secure_installation
systemctl status mysql.service
mysqladmin -p -u root version
```

### commands

```
mysql -u root -p
```

```
mysql> use logsearcher;
mysql> show tables;
```

## PHP

```
sudo apt-get install php php-mbstring php-xml php-mysql php7.0-fpm composer unzip
```

## nginx

Check this [Introduction](https://www.digitalocean.com/community/tutorials/how-to-deploy-a-laravel-application-with-nginx-on-ubuntu-16-04).

```
sudo apt-get install nginx

systemctl start nginx
systemctl stop nginx
systemctl restart nginx

sudo chown yzhang:yzhang /var/www/html/quickstart

sudo chgrp -R www-data storage bootstrap/cache

sudo chmod -R ug+rwx storage bootstrap/cache

# or use sudo chown -R 777 www-data /var/www/html/quickstart

```


```php /etc/nginx/conf.d/logsearcher.com

server {
    listen 8080;
    listen [::]:8080;

# SSL configuration
#
# listen 443 ssl default_server;
# listen [::]:443 ssl default_server;
#
# Note: You should disable gzip for SSL traffic.
# See: https://bugs.debian.org/773332
#
# Read up on ssl_ciphers to ensure a secure configuration.
# See: https://bugs.debian.org/765782
#
# Self signed certs generated by the ssl-cert package
# Don't use them in a production server!
#
# include snippets/snakeoil.conf;

    root /var/www/html/logsearcher/public;

# Add index.php to the list if you are using PHP
    index index.php index.html index.htm index.nginx-debian.html;

    server_name logsearcher.com www.logsearcher.com;

    location / {
# First attempt to serve request as file, then
# as directory, then fall back to displaying a 404.
        try_files $uri $uri/ /index.php;
    }

# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
#
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
#
#       # With php7.0-cgi alone:
#       fastcgi_pass 127.0.0.1:9000;
#       # With php7.0-fpm:
        fastcgi_pass unix:/run/php/php7.0-fpm.sock;
    }

# deny access to .htaccess files, if Apache's document root
# concurs with nginx's one
#
#location ~ /\.ht {
#       deny all;
#}
}

```

## composer

```bash
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php -r "if (hash_file('SHA384', 'composer-setup.php') === '669656bab3166a7aff8a7506b8cb2d1c292f042046c5a994c43155c0be6190fa0355160742ab2e1c88d40d5be660b410') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
php composer-setup.php
php -r "unlink('composer-setup.php');"
```

```
sudo mv composer.phar /usr/local/bin/composer
```

```vim .bashrc
# for mac
export PATH="$HOME/.composer/vendor/bin:$PATH"

# for ubuntu 
export PATH="$HOME/.config/composer/vendor/bin:$PATH"
```

## laravel

```
composer global require laravel/installer

```

### setup schedule on linux

```
crontab -e
* * * * * php /path-to-your-project/artisan schedule:run >> /dev/null 2>&1
```


### notice the timeout of php

Problem of Guzzle for opening the stream. Later find out, it was the timeout of php socket.
Make sure you have always set the timeout enough for a long term synchro call.


### configure the .env


```
cp .env.example .env

```


Make sure to change following config:

- QUEUE_DRIVER
- APP_ENV
- APP_DEBUG
- DB_DATABASE
- DB_USERNAME
- DB_PASSWORD

### run commands

```
composer install
php artisan migrate
```

## VIM

### install awesome vim

```
git clone --depth=1 https://github.com/amix/vimrc.git ~/.vim_runtime
sh ~/.vim_runtime/install_awesome_vimrc.sh
```


